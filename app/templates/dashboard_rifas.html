<!DOCTYPE html>
<html class="light" lang="es"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Mis Rifas - Borealis</title>
<link rel="icon" type="image/png" href="{{ url_for('static', filename='img/image.png') }}">
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
tailwind.config = {
darkMode: "class",
theme: {
extend: {
colors: {
"primary": "#ec5b13",
"background-light": "#f8f6f6",
"background-dark": "#221610",
},
fontFamily: {
"display": ["Public Sans", "sans-serif"]
},
borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
},
},
}
</script>
<style>
.glass {
background: rgba(255, 255, 255, 0.7);
backdrop-filter: blur(12px);
-webkit-backdrop-filter: blur(12px);
border: 1px solid rgba(255, 255, 255, 0.3);
}
.dark .glass {
background: rgba(34, 22, 16, 0.7);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.borealis-bg {
background: radial-gradient(circle at 0% 0%, rgba(236, 91, 19, 0.15) 0%, transparent 50%),
radial-gradient(circle at 100% 100%, rgba(43, 238, 205, 0.15) 0%, transparent 50%);
}
@keyframes pulse-green {
0%, 100% {
box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
}
50% {
box-shadow: 0 0 0 10px rgba(34, 197, 94, 0);
}
}
.pulse-green {
animation: pulse-green 2s infinite;
}
</style>
<style>
body {
min-height: max(884px, 100dvh);
}
</style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark min-h-screen borealis-bg text-slate-800 dark:text-slate-100">
<div class="relative min-h-screen pb-24">
<header class="sticky top-0 z-50 glass px-6 py-4 shadow-sm">
<div class="flex items-center justify-between">
<div>
<h1 class="text-xl font-bold tracking-tight">Mis Rifas</h1>
<p class="text-xs text-slate-500 dark:text-slate-400 mt-0.5">Gestiona tus sorteos activos</p>
</div>
<div class="flex gap-2">
<a href="{{ url_for('logout') }}" class="p-2 glass rounded-full hover:bg-red-500/10 transition-colors" title="Cerrar sesión">
<span class="material-symbols-outlined text-red-500">logout</span>
</a>
<button class="p-2 glass rounded-full">
<span class="material-symbols-outlined text-primary">notifications</span>
</button>
</div>
</div>
</header>
<main class="max-w-6xl mx-auto px-4 py-6 space-y-6">
<section>
<h2 class="text-lg font-bold mb-4 text-slate-800 dark:text-white">Rifas Activas</h2>
<div class="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
{% for rifa in rifas %}
{% if rifa.estado == 'Abierta' %}
{% set total_boletos = rifa.cantidad_numeros %}
{% set pagados = rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pagado')|list|length %}
{% set completada = pagados == total_boletos %}
<div class="glass rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 border {% if completada %}border-green-500 border-2 pulse-green{% else %}border-white/40 dark:border-white/10{% endif %} group">
{% if completada %}
<div class="absolute top-2 right-2 z-10 bg-green-500 text-white rounded-full p-2 shadow-lg">
<span class="material-symbols-outlined text-2xl">check_circle</span>
</div>
{% endif %}
{% if rifa.imagen %}
<div class="relative h-32 overflow-hidden">
<img alt="{{ rifa.nombre }}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500" src="{{ url_for('static', filename='uploads/' + rifa.imagen) }}"/>
{% if completada %}
<div class="absolute inset-0 bg-green-500/20 backdrop-blur-[1px]"></div>
{% endif %}
</div>
{% else %}
<div class="relative h-32 overflow-hidden bg-gradient-to-br from-primary/20 to-orange-400/20 flex items-center justify-center">
<span class="material-symbols-outlined text-5xl text-primary/40">book</span>
{% if completada %}
<div class="absolute inset-0 bg-green-500/20 backdrop-blur-[1px]"></div>
{% endif %}
</div>
{% endif %}
<div class="p-3">
<h3 class="font-bold text-base text-slate-900 dark:text-white mb-1 line-clamp-1">{{ rifa.nombre }}</h3>
<p class="text-xs text-slate-500 dark:text-slate-400 mb-3">Precio: ${{ rifa.precio }}</p>

{% if rifa.boleto_ganador_id %}
{% set ganador = rifa.boletos|selectattr('id', 'equalto', rifa.boleto_ganador_id)|first %}
<div class="mb-3 p-3 rounded-xl bg-gradient-to-br from-primary/10 to-orange-500/10 border-2 border-primary/30">
<div class="flex items-center justify-between">
<div class="flex items-center gap-2">
<span class="material-symbols-outlined text-primary text-2xl">emoji_events</span>
<p class="text-sm font-bold text-slate-900 dark:text-white">Boleto Ganador</p>
</div>
<div class="px-4 py-2 rounded-lg bg-primary text-white font-bold text-lg">
#{{ '%02d'|format(ganador.numero) if ganador else '00' }}
</div>
</div>
</div>
{% else %}
<div class="flex justify-between text-xs font-medium mb-1">
<span class="text-slate-600 dark:text-slate-300">Progreso</span>
<span class="text-primary">{{ (((rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pendiente')|list|length + rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pagado')|list|length) / rifa.cantidad_numeros) * 100)|round|int if rifa.cantidad_numeros > 0 else 0 }}%</span>
</div>
<div class="w-full bg-slate-200 dark:bg-white/10 rounded-full h-1.5 overflow-hidden mb-3">
<div class="bg-primary h-1.5 rounded-full" style="width: {{ (((rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pendiente')|list|length + rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pagado')|list|length) / rifa.cantidad_numeros) * 100)|round|int if rifa.cantidad_numeros > 0 else 0 }}%"></div>
</div>
{% endif %}

<div class="flex justify-between text-[10px] mb-3 pb-2 border-t border-slate-200 dark:border-white/10 pt-2">
<div class="text-center">
<p class="text-slate-400 uppercase">Vendidos</p>
<p class="font-bold text-slate-700 dark:text-slate-200">{{ rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pendiente')|list|length + rifa.boletos|selectattr('estatus_pago', 'equalto', 'Pagado')|list|length }}</p>
</div>
<div class="text-center">
<p class="text-slate-400 uppercase">Total</p>
<p class="font-bold text-slate-700 dark:text-slate-200">{{ rifa.cantidad_numeros }}</p>
</div>
</div>
<a href="{{ url_for('dashboard_boletos', rifa_id=rifa.id) }}" class="block w-full py-2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-lg font-medium text-xs shadow-md hover:opacity-90 transition-opacity text-center mb-2">
Gestionar
</a>
<div class="flex gap-2">
<a href="{{ url_for('editar_rifa', rifa_id=rifa.id) }}" class="flex-1 py-1.5 bg-blue-500 text-white rounded-lg font-medium text-[10px] hover:opacity-90 transition-opacity text-center flex items-center justify-center gap-1">
<span class="material-symbols-outlined text-xs">edit</span>
Editar
</a>
<button onclick="confirmarBorrar({{ rifa.id }})" class="flex-1 py-1.5 bg-red-500 text-white rounded-lg font-medium text-[10px] hover:opacity-90 transition-opacity flex items-center justify-center gap-1">
<span class="material-symbols-outlined text-xs">delete</span>
Borrar
</button>
</div>
</div>
</div>
{% endif %}
{% endfor %}
</div>
</section>
<section>
<a href="{{ url_for('dashboard_agregar') }}" class="block w-full group">
<div class="glass rounded-2xl p-6 border-2 border-dashed border-primary/30 dark:border-primary/20 hover:border-primary/60 dark:hover:border-primary/50 bg-white/30 dark:bg-white/5 hover:bg-white/50 dark:hover:bg-white/10 transition-all duration-300 flex flex-col items-center justify-center text-center gap-3">
<div class="w-14 h-14 rounded-full bg-gradient-to-tr from-primary to-orange-400 flex items-center justify-center shadow-lg shadow-orange-500/20 group-hover:scale-110 transition-transform duration-300">
<span class="material-symbols-outlined text-white text-3xl">add</span>
</div>
<div>
<h3 class="text-lg font-bold text-slate-800 dark:text-white">Crear Nueva Rifa</h3>
<p class="text-sm text-slate-500 dark:text-slate-400 mt-1 max-w-xs mx-auto">Configura un nuevo sorteo, define los premios y la cantidad de boletos.</p>
</div>
</div>
</a>
</section>
<section class="grid grid-cols-2 gap-4 pb-4">
<div class="glass p-4 rounded-xl flex items-center gap-3">
<div class="p-2 bg-blue-100 dark:bg-blue-500/20 rounded-lg text-blue-600 dark:text-blue-400">
<span class="material-symbols-outlined text-xl">inventory_2</span>
</div>
<div>
<p class="text-xs text-slate-500 dark:text-slate-400">Total Rifas</p>
<p class="font-bold text-slate-800 dark:text-white">{{ rifas|length }}</p>
</div>
</div>
<div class="glass p-4 rounded-xl flex items-center gap-3">
<div class="p-2 bg-emerald-100 dark:bg-emerald-500/20 rounded-lg text-emerald-600 dark:text-emerald-400">
<span class="material-symbols-outlined text-xl">check_circle</span>
</div>
<div>
<p class="text-xs text-slate-500 dark:text-slate-400">Finalizadas</p>
<p class="font-bold text-slate-800 dark:text-white">{{ rifas|selectattr('estado', 'equalto', 'Cerrada')|list|length }}</p>
</div>
</div>
</section>
</main>
<nav class="fixed bottom-0 left-0 right-0 glass border-t border-slate-200 dark:border-white/5 px-6 py-4 z-40 bg-white/80 dark:bg-[#221610]/80">
<div class="flex justify-between items-center max-w-lg mx-auto">
<a class="flex flex-col items-center gap-1 text-primary relative" href="{{ url_for('dashboard_rifas') }}">
<span class="material-symbols-outlined">confirmation_number</span>
<span class="text-[10px] font-medium">Rifas</span>
<span class="absolute -top-1 right-2 w-2 h-2 bg-primary rounded-full animate-pulse"></span>
</a>
</div>
</nav>
<script>
function confirmarBorrar(rifaId) {
if (confirm('¿Estás seguro de que deseas eliminar esta rifa? Esta acción no se puede deshacer.')) {
window.location.href = `/borrar_rifa/${rifaId}`;
}
}
</script>
</div>
</body></html>
